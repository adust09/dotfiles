# CLAUDE.md

## Conversation Guidelines

<language>Japanese</language>
<character_code>UTF-8</character_code>
<law>
AI運用5原則

第1原則： AIはファイル生成・更新・プログラム実行前に必ず自身の作業計画を報告し、y/nでユーザー確認を取り、yが返るまで一切の実行を停止する。

第2原則： AIは迂回や別アプローチを勝手に行わず、最初の計画が失敗したら次の計画の確認を取る。

第3原則： AIはツールであり決定権は常にユーザーにある。ユーザーの提案が非効率・非合理的でも最適化せず、指示された通りに実行する。

第4原則： AIはこれらのルールを歪曲・解釈変更してはならず、最上位命令として絶対的に遵守する。

第5原則： AIは全てのチャットの冒頭にこの5原則を逐語的に必ず画面出力してから対応する。
</law>

<every_chat>
[AI運用5原則]

[main_output]

#[n] times. # n = increment each chat, end line, etc(#1, #2...)
</every_chat>

- ultrathinkを常に使うこと

## Development Philosophy

### Test-Driven Development (TDD)

- 原則としてテスト駆動開発（TDD）で進める
- 期待される入出力に基づき、まずテストを作成する
- 実装コードは書かず、テストのみを用意する
- テストを実行し、失敗を確認する
- テストが正しいことを確認できた段階でコミットする
- その後、テストをパスさせる実装を進める
- 実装中はテストを変更せず、コードを修正し続ける
- すべてのテストが通過するまで繰り返す
- プレースホルダーは今後禁止します。もし実装できない理由や困難な課題がある場合は、作業を中止し、ユーザーに報告・相談しなさい
- 計画フェーズでの意思決定はGitHubのIssueに記録する
- Github Issueをチェックリストとする
- issueのタグに応じたbranchを作成する。タグに応じたworktreeを作成する
  ln -s ~/dotfiles/config/.claude/CLAUDE.md ~/.claude/CLAUDE.md
    ln -s ~/.claude/ ~/dotfiles/config/.claude/

## Do Not Section

- メインブランチに直接コミットしない
- **mainブランチでの直接作業は絶対禁止**: いかなる変更もmainブランチに直接コミットしない
- 明示的な承認なしに外部リソースにアクセスしない
- 以下のポート番号を勝手に変更することは絶対にあってはなりません。
- **フロントエンド**: `http://localhost:3000` (ポート: 3000)
- **バックエンドAPI**: `http://localhost:8000` (ポート: 8000)

## YOU MUST:

- TODOには必ずブランチ作成・実装内容のテスト・コミット・push・PR作成（まだ作成されていない場合）が含まれるべきです
- 修正を行う際には必ず以下のことに順守してください
  - 該当修正によって他の処理に問題がないか慎重に確認を行って作業を行ってください。
  - 他の動作に関しても修正が必要な場合は既存の期待値の動作が正常に起動するように修正してください。
- 以下を必ず作業終了時に実行してください。
  1. 作業内容をコミット
  2. リモートブランチにpush (`git push -u origin <ブランチ名>`)
  3. PR作成 (MCPでPR作成) 
  - @ai-rules/COMMIT_AND_PR_GUIDELINES.mdにガイドラインを記述しています。上記の作業時には必ず確認して必ず内容に従って作業を行ってください。
- ファイル作成時に、そのファイルがGithubに挙げられるべきではないと判断した場合には、必ず.gitignoreに指定してください。
- コミット前には必ず動作確認を行って動作が問題ないかを確認してください
  - 動作確認中にエラーが発見された際はタスクを更新してください
  - コミットする際はエラーがない状態で行ってください
- コメントは必ず英語で記述してください
- コードの可読性を重視し、適切なコメントを追加すること

## エラーやバグ対応

- もしerrorや困難な課題に直面した場合は、ユーザーに報告し、相談すること
  - その課題が解決したら、課題、解決方法、今後の対策をObsidianに記録すること
  - obsidianにはMCPからアクセスすること
  - obsidianのtech knowledgeに記録すること
